\hypertarget{memory__buffer__alloc_8h}{\section{C\-:/dev2/luambedtls/dependencies/mbedtls/include/mbedtls/memory\-\_\-buffer\-\_\-alloc.h File Reference}
\label{memory__buffer__alloc_8h}\index{C\-:/dev2/luambedtls/dependencies/mbedtls/include/mbedtls/memory\-\_\-buffer\-\_\-alloc.\-h@{C\-:/dev2/luambedtls/dependencies/mbedtls/include/mbedtls/memory\-\_\-buffer\-\_\-alloc.\-h}}
}


Buffer-\/based memory allocator.  


{\ttfamily \#include \char`\"{}config.\-h\char`\"{}}\\*
{\ttfamily \#include $<$stddef.\-h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{memory__buffer__alloc_8h_a2b9fd1ef7a128cf7680e6c9c377134d4}{\#define {\bfseries M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-N\-O\-N\-E}~0}\label{memory__buffer__alloc_8h_a2b9fd1ef7a128cf7680e6c9c377134d4}

\item 
\hypertarget{memory__buffer__alloc_8h_a3fb815b3f3b7cfce7c5ddd6f2a33b80d}{\#define {\bfseries M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-A\-L\-L\-O\-C}~(1 $<$$<$ 0)}\label{memory__buffer__alloc_8h_a3fb815b3f3b7cfce7c5ddd6f2a33b80d}

\item 
\hypertarget{memory__buffer__alloc_8h_a1c7f2d8956e95373dcb4fe24154b6650}{\#define {\bfseries M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-F\-R\-E\-E}~(1 $<$$<$ 1)}\label{memory__buffer__alloc_8h_a1c7f2d8956e95373dcb4fe24154b6650}

\item 
\hypertarget{memory__buffer__alloc_8h_a581a709e67d33b34d3c8a7dfb4b3df00}{\#define {\bfseries M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-A\-L\-W\-A\-Y\-S}~(M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-A\-L\-L\-O\-C $|$ M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-F\-R\-E\-E)}\label{memory__buffer__alloc_8h_a581a709e67d33b34d3c8a7dfb4b3df00}

\end{DoxyCompactItemize}
\begin{Indent}{\bf S\-E\-C\-T\-I\-O\-N\-: Module settings}\par
{\em The configuration options you can set for this module are in this section. Either change them in \hyperlink{config_8h}{config.\-h} or define them on the compiler command line. }\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{memory__buffer__alloc_8h_a1fa1e20d4ff40eb6c2a740d7d26b2749}{M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-A\-L\-I\-G\-N\-\_\-\-M\-U\-L\-T\-I\-P\-L\-E}~4
\end{DoxyCompactItemize}
\end{Indent}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{memory__buffer__alloc_8h_ac70d134be54133c272d8eab2cb85dfbf}{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-init} (unsigned char $\ast$buf, size\-\_\-t len)
\begin{DoxyCompactList}\small\item\em Initialize use of stack-\/based memory allocator. The stack-\/based allocator does memory management inside the presented buffer and does not call calloc() and free(). It sets the global mbedtls\-\_\-calloc() and mbedtls\-\_\-free() pointers to its own functions. (Provided mbedtls\-\_\-calloc() and mbedtls\-\_\-free() are thread-\/safe if M\-B\-E\-D\-T\-L\-S\-\_\-\-T\-H\-R\-E\-A\-D\-I\-N\-G\-\_\-\-C is defined) \end{DoxyCompactList}\item 
\hypertarget{memory__buffer__alloc_8h_ae9d7316a19b72776f34ba74720a06325}{void \hyperlink{memory__buffer__alloc_8h_ae9d7316a19b72776f34ba74720a06325}{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-free} (void)}\label{memory__buffer__alloc_8h_ae9d7316a19b72776f34ba74720a06325}

\begin{DoxyCompactList}\small\item\em Free the mutex for thread-\/safety and clear remaining memory. \end{DoxyCompactList}\item 
void \hyperlink{memory__buffer__alloc_8h_aaa50603bb2f2f1fe8d97d6953589b832}{mbedtls\-\_\-memory\-\_\-buffer\-\_\-set\-\_\-verify} (int verify)
\begin{DoxyCompactList}\small\item\em Determine when the allocator should automatically verify the state of the entire chain of headers / meta-\/data. (Default\-: M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-N\-O\-N\-E) \end{DoxyCompactList}\item 
int \hyperlink{memory__buffer__alloc_8h_a7aae8a0cd61f08dd6734ebc8a8a3ba38}{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-verify} (void)
\begin{DoxyCompactList}\small\item\em Verifies that all headers in the memory buffer are correct and contain sane values. Helps debug buffer-\/overflow errors. \end{DoxyCompactList}\item 
int \hyperlink{memory__buffer__alloc_8h_ab1304c317468fb66c21ee52c79efe084}{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-self\-\_\-test} (int verbose)
\begin{DoxyCompactList}\small\item\em Checkup routine. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Buffer-\/based memory allocator. Copyright (C) 2006-\/2015, A\-R\-M Limited, All Rights Reserved

This file is part of mbed T\-L\-S (\href{https://tls.mbed.org}{\tt https\-://tls.\-mbed.\-org})

This program is free software; you can redistribute it and/or modify it under the terms of the G\-N\-U General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U General Public License for more details.

You should have received a copy of the G\-N\-U General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, M\-A 02110-\/1301 U\-S\-A. 

Definition in file \hyperlink{memory__buffer__alloc_8h_source}{memory\-\_\-buffer\-\_\-alloc.\-h}.



\subsection{Macro Definition Documentation}
\hypertarget{memory__buffer__alloc_8h_a1fa1e20d4ff40eb6c2a740d7d26b2749}{\index{memory\-\_\-buffer\-\_\-alloc.\-h@{memory\-\_\-buffer\-\_\-alloc.\-h}!M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-A\-L\-I\-G\-N\-\_\-\-M\-U\-L\-T\-I\-P\-L\-E@{M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-A\-L\-I\-G\-N\-\_\-\-M\-U\-L\-T\-I\-P\-L\-E}}
\index{M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-A\-L\-I\-G\-N\-\_\-\-M\-U\-L\-T\-I\-P\-L\-E@{M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-A\-L\-I\-G\-N\-\_\-\-M\-U\-L\-T\-I\-P\-L\-E}!memory_buffer_alloc.h@{memory\-\_\-buffer\-\_\-alloc.\-h}}
\subsubsection[{M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-A\-L\-I\-G\-N\-\_\-\-M\-U\-L\-T\-I\-P\-L\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-A\-L\-I\-G\-N\-\_\-\-M\-U\-L\-T\-I\-P\-L\-E~4}}\label{memory__buffer__alloc_8h_a1fa1e20d4ff40eb6c2a740d7d26b2749}
Align on multiples of this value 

Definition at line 44 of file memory\-\_\-buffer\-\_\-alloc.\-h.



\subsection{Function Documentation}
\hypertarget{memory__buffer__alloc_8h_ac70d134be54133c272d8eab2cb85dfbf}{\index{memory\-\_\-buffer\-\_\-alloc.\-h@{memory\-\_\-buffer\-\_\-alloc.\-h}!mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-init@{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-init}}
\index{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-init@{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-init}!memory_buffer_alloc.h@{memory\-\_\-buffer\-\_\-alloc.\-h}}
\subsubsection[{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-init (
\begin{DoxyParamCaption}
\item[{unsigned char $\ast$}]{buf, }
\item[{size\-\_\-t}]{len}
\end{DoxyParamCaption}
)}}\label{memory__buffer__alloc_8h_ac70d134be54133c272d8eab2cb85dfbf}


Initialize use of stack-\/based memory allocator. The stack-\/based allocator does memory management inside the presented buffer and does not call calloc() and free(). It sets the global mbedtls\-\_\-calloc() and mbedtls\-\_\-free() pointers to its own functions. (Provided mbedtls\-\_\-calloc() and mbedtls\-\_\-free() are thread-\/safe if M\-B\-E\-D\-T\-L\-S\-\_\-\-T\-H\-R\-E\-A\-D\-I\-N\-G\-\_\-\-C is defined) 

\begin{DoxyNote}{Note}
This code is not optimized and provides a straight-\/forward implementation of a stack-\/based memory allocator.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em buf} & buffer to use as heap \\
\hline
{\em len} & size of the buffer \\
\hline
\end{DoxyParams}
\hypertarget{memory__buffer__alloc_8h_ab1304c317468fb66c21ee52c79efe084}{\index{memory\-\_\-buffer\-\_\-alloc.\-h@{memory\-\_\-buffer\-\_\-alloc.\-h}!mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-self\-\_\-test@{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-self\-\_\-test}}
\index{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-self\-\_\-test@{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-self\-\_\-test}!memory_buffer_alloc.h@{memory\-\_\-buffer\-\_\-alloc.\-h}}
\subsubsection[{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-self\-\_\-test}]{\setlength{\rightskip}{0pt plus 5cm}int mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-self\-\_\-test (
\begin{DoxyParamCaption}
\item[{int}]{verbose}
\end{DoxyParamCaption}
)}}\label{memory__buffer__alloc_8h_ab1304c317468fb66c21ee52c79efe084}


Checkup routine. 

\begin{DoxyReturn}{Returns}
0 if successful, or 1 if a test failed 
\end{DoxyReturn}
\hypertarget{memory__buffer__alloc_8h_a7aae8a0cd61f08dd6734ebc8a8a3ba38}{\index{memory\-\_\-buffer\-\_\-alloc.\-h@{memory\-\_\-buffer\-\_\-alloc.\-h}!mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-verify@{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-verify}}
\index{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-verify@{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-verify}!memory_buffer_alloc.h@{memory\-\_\-buffer\-\_\-alloc.\-h}}
\subsubsection[{mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-verify}]{\setlength{\rightskip}{0pt plus 5cm}int mbedtls\-\_\-memory\-\_\-buffer\-\_\-alloc\-\_\-verify (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{memory__buffer__alloc_8h_a7aae8a0cd61f08dd6734ebc8a8a3ba38}


Verifies that all headers in the memory buffer are correct and contain sane values. Helps debug buffer-\/overflow errors. 

\begin{DoxyVerb}     Prints out first failure if MBEDTLS_MEMORY_DEBUG is defined.
     Prints out full header information if MBEDTLS_MEMORY_DEBUG
     is defined. (Includes stack trace information for each block if
     MBEDTLS_MEMORY_BACKTRACE is defined as well).
\end{DoxyVerb}


\begin{DoxyReturn}{Returns}
0 if verified, 1 otherwise 
\end{DoxyReturn}
\hypertarget{memory__buffer__alloc_8h_aaa50603bb2f2f1fe8d97d6953589b832}{\index{memory\-\_\-buffer\-\_\-alloc.\-h@{memory\-\_\-buffer\-\_\-alloc.\-h}!mbedtls\-\_\-memory\-\_\-buffer\-\_\-set\-\_\-verify@{mbedtls\-\_\-memory\-\_\-buffer\-\_\-set\-\_\-verify}}
\index{mbedtls\-\_\-memory\-\_\-buffer\-\_\-set\-\_\-verify@{mbedtls\-\_\-memory\-\_\-buffer\-\_\-set\-\_\-verify}!memory_buffer_alloc.h@{memory\-\_\-buffer\-\_\-alloc.\-h}}
\subsubsection[{mbedtls\-\_\-memory\-\_\-buffer\-\_\-set\-\_\-verify}]{\setlength{\rightskip}{0pt plus 5cm}void mbedtls\-\_\-memory\-\_\-buffer\-\_\-set\-\_\-verify (
\begin{DoxyParamCaption}
\item[{int}]{verify}
\end{DoxyParamCaption}
)}}\label{memory__buffer__alloc_8h_aaa50603bb2f2f1fe8d97d6953589b832}


Determine when the allocator should automatically verify the state of the entire chain of headers / meta-\/data. (Default\-: M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-N\-O\-N\-E) 


\begin{DoxyParams}{Parameters}
{\em verify} & One of M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-N\-O\-N\-E, M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-A\-L\-L\-O\-C, M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-F\-R\-E\-E or M\-B\-E\-D\-T\-L\-S\-\_\-\-M\-E\-M\-O\-R\-Y\-\_\-\-V\-E\-R\-I\-F\-Y\-\_\-\-A\-L\-W\-A\-Y\-S \\
\hline
\end{DoxyParams}
